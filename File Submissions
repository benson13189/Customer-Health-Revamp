SELECT 
  
  distinct(report_status.STORE_CHAIN_ID) as SID,
  report_status.PERIOD_END_AT AS Reporting_Period,
    case webapi_report.status
      WHEN 0 THEN 'not_ready'
      WHEN 1 THEN 'ready_to_submit'
      WHEN 2 THEN 'generation_pending'
      WHEN 3 THEN 'submitted'
      WHEN 4 THEN 'generation_failed'
      WHEN 5 THEN 'submission_failed'
      WHEN 6 THEN 'regenerate'
      WHEN 7 THEN 'force_submitted'
      WHEN 8 THEN 'submission_pending'
    Else 'NA'
    END as report_status,
    case report_status.status
      WHEN 0 THEN 'Validated'
      WHEN 1 THEN 'Resync'
      WHEN 2 THEN 'Refetch'
      WHEN 3 THEN 'Invalid'
      ELSE 'n/a'
    END as data_status,
    sfdc_account.customer_health_score__c
  FROM PROD.TSD.STORE_STATUS_PER_PERIOD as report_status
  Join "PC_STITCH_DB"."STITCH_R1000"."REPORTS" as webapi_report
  ON webapi_report.request_id = report_status.request_id
   join "PC_STITCH_DB"."STITCH_R1000"."REPORT_ACCOUNTS" as accounts
  ON report_status.report_account_id = accounts.id
  and webapi_report.report_type IN (0)
  join "PROD"."SALESFORCE"."ACCOUNT" as sfdc_account
  on sid = sfdc_account.store_id__c
  order by reporting_period desc
